<div *ngIf="data$ | async as student; else loadingSkeleton" class="mt-8">
  <div class="flex gap-4 flex-wrap text-center">
    <div
      class="flex-1 p-4 flex flex-col justify-around items-center font-semibold text-lg rounded-3xl bg-amber-400 text-white"
    >
      <p>{{ student.topMarks }}/300</p>
      <p class="text-sm font-normal">Top Marks</p>
    </div>
    <div
      class="flex-1 p-4 flex flex-col justify-around items-center font-semibold text-lg rounded-3xl bg-rose-500 text-white"
    >
      <p>{{ student.averageMarks }}/300</p>
      <p class="text-sm font-normal">Average Marks</p>
    </div>
    <div
      class="flex-1 p-4 flex flex-col justify-around items-center font-semibold text-lg rounded-3xl bg-indigo-500 text-white"
    >
      <p>
        {{
          getOverollAccuracy(
            student.physicsAccuracy,
            student.mathAccuracy,
            student.chemistryAccuracy
          )
        }}%
      </p>
      <p class="text-sm font-normal">Average Accuracy</p>
    </div>
  </div>
  <div class="flex flex-wrap gap-4 mt-5">
    <div class="flex-1 bg-white shadow min-w-[250px] rounded-3xl p-5">
      <h2 class="font-semibold mb-5 text-sm">Precision by Subject</h2>
      <div class="my-auto">
        <div class="mb-2">
          <h5>Chemistry</h5>
          <div class="flex gap-2 items-center">
            <div class="flex-1 h-4 bg-gray-300 rounded-full">
              <div
                class="h-4 bg-blue-500 rounded-full"
                [style.width]="student.chemistryAccuracy + '%'"
              ></div>
            </div>
            <span class="w-10">{{ roundOff(student.chemistryAccuracy) }}%</span>
          </div>
        </div>
        <div class="mb-2">
          <h5>Physics</h5>
          <div class="flex gap-2 items-center">
            <div class="flex-1 h-4 bg-gray-300 rounded-full">
              <div
                class="h-4 bg-blue-500 rounded-full"
                [style.width]="student.physicsAccuracy + '%'"
              ></div>
            </div>
            <span class="w-10">{{ roundOff(student.physicsAccuracy) }}%</span>
          </div>
        </div>
        <div class="mb-2">
          <h5>Math</h5>
          <div class="flex gap-2 items-center">
            <div class="flex-1 h-4 bg-gray-300 rounded-full">
              <div
                class="h-4 bg-blue-500 rounded-full"
                [style.width]="student.mathAccuracy + '%'"
              ></div>
            </div>
            <span class="w-10">{{ roundOff(student.mathAccuracy) }}%</span>
          </div>
        </div>
      </div>
    </div>
    <div class="flex-1 bg-white shadow min-w-[250px] rounded-3xl p-5">
      <h2 class="font-semibold mb-5 text-sm">Subject-Specific Timing</h2>
      <div class="my-auto">
        <div>
          <div class="flex justify-center gap-2">
            <div
              class="bg-sky-400 w-[72px] rounded-full text-white semibold aspect-square flex justify-center items-center"
            >
              {{ roundOff(student.chemistryAccuracy) }}s
            </div>
            <div>
              <div
                class="bg-green-400 w-16 rounded-full text-white semibold aspect-square flex justify-center items-center"
              >
                {{ roundOff(student.mathAccuracy) }}s
              </div>
            </div>
          </div>
          <div
            class="bg-red-400 mx-auto w-14 rounded-full text-white semibold aspect-square flex justify-center items-center"
          >
            {{ roundOff(student.physicsAccuracy) }}s
          </div>
        </div>
        <div class="flex justify-center gap-3 flex-wrap mt-3 items-center">
          <p>
            <span class="inline-block w-8 h-3 mr-2 bg-sky-400 my-auto"></span
            >Chemistry
          </p>
          <p>
            <span class="inline-block w-8 h-3 mr-2 bg-red-400 my-auto"></span
            >Physics
          </p>
          <p>
            <span class="inline-block w-8 h-3 mr-2 bg-green-400 my-auto"></span
            >Math
          </p>
        </div>
        <p class="text-center mt-2 text-xs text-gray-600 ">Average Time Spent Solving Each Question</p>
      </div>
    </div>
  </div>
  <p class="my-3 text-gray-500 ml-1">
    *This Data is Based on your previous test results
  </p>
</div>
<ng-template #loadingSkeleton>
  <div class="py-2 mt-7 bg-gray-100">
    <div class="flex gap-4 flex-wrap">
      <div class="flex-1 min-w-[100px] h-20 rounded-3xl skeleton-loader"></div>
      <div class="flex-1 min-w-[100px] h-20 rounded-3xl skeleton-loader"></div>
      <div class="flex-1 min-w-[100px] h-20 rounded-3xl skeleton-loader"></div>
    </div>
    <div class="flex gap-4 mt-4 flex-wrap">
      <div
        class="h-[240px] min-w-[250px] rounded-3xl flex-1 skeleton-loader"
      ></div>
      <div
        class="h-[240px] min-w-[250px] rounded-3xl flex-1 skeleton-loader"
      ></div>
    </div>
    <div class="h-4 w-full mt-3 skeleton-loader"></div>
  </div>
</ng-template>
